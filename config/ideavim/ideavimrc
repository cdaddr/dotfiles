set ideamarks
set ideajoin

set ideaput
set idearefactormode=select
set ideastatusicon=gray
set ideaenabledbufs=
set clipboard+=unnamedplus
set showcmd

set incsearch
set hlsearch
set scrolloff=5
set nrformats+=alpha,octal

" plugins
set commentary
set surround
set highlightedyank
" set matchit
set textobj-entire
set exchange

let g:argtextobj_pairs="(:),{:},<:>,[:]"
set argtextobj
set clipboard=unnamed,unnamedplus,ideaput
" remove vim mode from dialogs
set ideavimsupport=

let mapleader = " "

nmap Y y$

map <Leader>a <Action>(GotoAction)
map <Leader><Leader> <Action>(SearchEverywhere)
map <Leader>r <Action>(RenameElement)
map <Leader>f <Action>(FindInPath)
-- map <Leader>g <Action>(Generate)
map <Leader>t <Action>(TypeHierarchy)
map <Leader>c <Action>(CallHierarchy)
map <Leader>o <Action>(GotoFile)
map <Leader>e <Action>(SurroundWithEmmet)
map <Leader>s <Action>(SurroundWith)
map <Leader>gu <Action>(ShowUsages)
map gt <Action>(GotoTypeDeclaration)

vmap g{ "zc{[<C-r>z]}<esc>va{

vmap <C-o> <Esc><C-o>
vmap <C-i> <Esc><C-i>

function! SmartWrap()
  let char = strpart(getline('.'), col('.') - 1, 1)
  if char =~ '["'']'
    normal! va"
  elseif char =~ '\w'
    normal! viw
  else
    return
  endif
  echo "start"
  echo char
  echo strpart(line('.'), col('.'), 1)
  echo "done"
endfunction

nmap <D-F12> :call SmartWrap()<CR>

imap <M-{> <ESC>ysa{<C-O>a

nnoremap <C-t> :tabn<cr>
nnoremap <S-C-t> :tabp<cr>
nnoremap t :tabn<cr>
nnoremap T :tabp<cr>

map <Leader>m <Action>(HarpoonMark)
map <Leader>d <Action>(HarpoonRemove)
map <Leader>C <Action>(HarpoonClear)
map <Leader>M <Action>(HarpoonList)
map <Leader>n <Action>(HarpoonNext)
map <Leader>N <Action>(HarpoonPrevious)
map <Tab> <Action>(HarpoonNext)
map <s-Tab> <Action>(HarpoonPrevious)

" nmap <Tab> :tabn<cr>
" nmap <S-Tab> :tabp<cr>

map ]m <Action>(MethodDown)
map [m <Action>(MethodUp)

map ]] <Action>(MethodDown)
map [[ <Action>(MethodUp)

nmap <Esc> :nohls<CR>
nmap / <Action>(Find)
vmap / <Action>(Macro.find.in.selection)

nmap n <Action>(FindNext)
vmap n <Action>(FindNext)

nmap N <Action>(FindPrevious)
vmap N <Action>(FindPrevious)

function! MaybeBackwards()
echo line('.')
    "if col('.') === 1 || line('.')
endfunction

" nmap <Leader>gs :s/["'].*['"]/{[\0,]}/<CR>

sethandler <D-f> a:vim
nmap <D-f> <Action>(Find)
" vmap <D-f> <Action>(Macro.find.in.selection)

nmap * he<Action>(FindWordAtCaret)<ESC>n
nmap <Leader>gs <Action>(SplitAction)

nmap % <Action>(EditorMatchBrace)
nmap <Leader>w <Esc>vipJgqq

nmap <C-o> <Action>(Back)
nmap <C-i> <Action>(Forward)
nmap g; <Action>(JumpToLastChange)
nmap g, <Action>(JumpToNextChange)
nmap zi <Action>(ExpandAllRegions)

nmap <C-}> <Nop>

nmap <C-w>= <Action>(MaximizeEditorInSplit)
nmap <C-w>\| <Action>(MaximizeEditorInSplit)
nmap <C-w>L <Action>(MoveEditorToOppositeTabGroup)
nmap <C-w>H <Action>(MoveEditorToOppositeTabGroup)

" map <Leader>[ <Action>(EditorCodeBlockStart)
" map <Leader>] <Action>(EditorCodeBlockEnd)

map <Leader>h :nohls<CR>

map \ <Leader>

" map <Leader>y "+y
" map <Leader>p "+p
" map <Leader>P "+P

" map <Leader>d "_d
" map <Leader>D "_D
" map <Leader>x "_x
" map <Leader>x "_x

" imap <silent> <C-j> <esc>:m .+<CR>==gi
" imap <silent> <C-k> <esc>:m .-2<CR>==gi
" 
" nmap <silent> <C-j> :m .+<CR>==
" nmap <silent> <C-k> :m .-2<CR>==
" vmap <silent> <C-j> :m '>+<CR>gv=gv
" vmap <silent> <C-k> :m '<-2<CR>gv=gv

nmap gss :s@\v(.* \= )(.*);@\1$state(\2);@<CR>

vmap < <gv
vmap > >gv

nmap <Leader>L <Action>(MoveTabRight)

" this makes m-lowercase use IDE bookmarks always
nmap 'a 'A
nmap 'b 'B
nmap 'c 'C
nmap 'd 'D
nmap 'e 'E
nmap 'f 'F
nmap 'g 'G
nmap 'h 'H
nmap 'i 'I
nmap 'j 'J
nmap 'k 'K
nmap 'l 'L
nmap 'm 'M
nmap 'n 'N
nmap 'o 'O
nmap 'p 'P
nmap 'q 'Q
nmap 'r 'R
nmap 's 'S
nmap 't 'T
nmap 'u 'U
nmap 'v 'V
nmap 'w 'W
nmap 'x 'X
nmap 'y 'Y
nmap 'z 'Z

nmap ma mA
nmap mb mB
nmap mc mC
nmap md mD
nmap me mE
nmap mf mF
nmap mg mG
nmap mh mH
nmap mi mI
nmap mj mJ
nmap mk mK
nmap ml mL
nmap mm mM
nmap mn mN
nmap mo mO
nmap mp mP
nmap mq mQ
nmap mr mR
nmap ms mS
nmap mt mT
nmap mu mU
nmap mv mV
nmap mw mW
nmap mx mX
nmap my mY
nmap mz mZ
